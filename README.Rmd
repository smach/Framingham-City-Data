---
title: "Framingham City Data (Unofficial)"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This project aims to collect important data about Framingham, Massachusetts and wrangle it so it is in a form useful for analysis. 

Data may be in one of two formats -- "tidy", sometimes called "long", with one observation in each row; or more human-readable format, with multiple data points per row. Tidy data is useful for analysis in R and other platforms (including as a basis for Excel pivot tables) and will include tidy in the file name.

The data generally start in 2017 with Framingham's transition from town to city form of government. Election data will not include preliminary elections unless they are city-wide.


Data added so far: 

* GIS files for precincts in new city districts

* Results of Framingham's first-ever city general election in November 2017

* Results of Framingham's first-ever city preliminary election in September 2017


A few notes on structure and format:

* The data directory includes data in usable format for analysis.

* The data/gis subdirectory includes GIS files and maps, such as precinct and district shapefiles. 

* The data/elections subdirectory includes, not surprisingly, information about election results but also precinct polling places.

* When initial data was not in a usable format for analysis, such as PDFs from the City Clerk's office, the original data file is in the data-raw directory. 

* Some R files used to reshape the data have been included in the R directory. 

* PDFs were converted to Excel using the [CometDocs cloud service](https://www.cometdocs.com/).)

## Available files

*data/district_precinct_info.csv* -- which Framingham precincts make up each district.

### Elections

All election results data come from the Framingham Clerk's office.

#### 2017 general on Nov. 7

*data/elections/2017_general_turnout_framingham.csv* -- turnout by precinct <br />
*data/elections/2017_general_turnout_bydistrict_framingham.csv* -- turnout by district <br />
*data/elections/2017_general_tidy_framingham.csv* <br /> -- complete results file (excluding turnout) by _precinct_ in "tidy"/long format ready for analysis in R, Excel pivot tables, or other platforms. <br />
*data/elections/2017_general_bydistrict_tidy_framingham_tidy.csv*  -- complete results file (excluding turnout) by _district_ in "tidy"/long format ready for analysis in R, Excel pivot tables, or other platforms.<br />
*data/elections/2017_general_mayor_framingham.csv* <br />
*data/elections/2017_general_mayor_bydistrict_framingham.csv*<br />
*data/elections/2017_general_atlarge_framingham.csv* <br />
*data/elections/2017_general_atlarge_bydistrict_framingham.csv* <br />
*data/elections/2017_general_district_council_bydistrict_tidy_framingham.csv* <br />
*data/elections/2017_general_school_committee_bydistrict_tidy_framingham.csv*

#### 2017 preliminary on Sept. 26

*data/elections/2017_preliminary_turnout_framingham.csv* -- turnout by precinct <br />
*data/elections/2017_preliminary_turnout_bydistrict_framingham.csv* -- turnout by district <br />
*data/elections/2017_preliminary_tidy_framingham.csv* <br /> -- complete results file (excluding turnout) by precinct in "tidy"/long format ready for analysis in R, Excel pivot tables, or other platforms.
*data/elections/2017_preliminary_bydistrict_tidy_framingham.csv*  -- complete results file (excluding turnout) by district in "tidy"/long format ready for analysis in R, Excel pivot tables, or other platforms.<br />
*data/elections/2017_preliminary_mayor_framingham.csv* <br />
*data/elections/2017_preliminary_mayor_framingham_tidy.csv* <br />
*data/elections/2017_preliminary_atlarge_framingham.csv* <br />
*data/elections/2017_preliminary_atlarge_framingham_tidy.csv* <br />
*data/elections/2017_preliminary_district_council_bydistrict_tidy_framingham.csv*

#### 2017 vote on city charter April 4

*data/elections/2017_charter_turnout_framingham.csv*<br />
*data/elections/2017_charter_results_framingham.csv*<br />
*data/elections/2017_charter_results_tidy_framingham.csv* -- complete vote and turnout by precinct including turnout in "tidy"/long format ready for analysis in R, Excel pivot tables, or other platforms.

#### Raw election data files

*data-raw/elections/election_general_2017_framingham_raw.pdf* -- PDF of official Framingham November 2017 election results. [File posted on the Framingham website](http://www.framinghamma.gov/DocumentCenter/View/28924). 

*data-raw/elections/election_general_2017_framingham_raw.xlsx* -- Official Framingham November 2017 election results converted from PDF to Excel by [CometDocs](https://www.cometdocs.com/).

*data-raw/elections/election_preliminary_2017_framingham_raw.pdf* -- Official Framingham September 2017 preliminary election results converted from PDF to Excel by [CometDocs](https://www.cometdocs.com/).

*data-raw/elections/election_preliminary_2017_framingham_raw.xlsx* -- Official Framingham September 2017 preliminary election results converted from PDF to Excel by [CometDocs](https://www.cometdocs.com/).

*data-raw/elections/election_charter_2017_framingham_raw.xlsx* -- results of the April 2017 vote on the city charter.

*data-raw/elections/election-town-2017_framingham-raw.pdf* -- Official Framingham April 2017 town election results.


### GIS files

*data/gis/FramPrecincts/* - shapefile of Framingham precincts. Includes District info. Shapefile wsd received from Geoffrey W. Kovar, Framingham GIS Manager, via email on July 14, 2017.

Read shapefile into R with the tmaptools package:

```{r eval=FALSE}
library(sf)
framgeo <- tmaptools::read_shape("data/gis/FramPrecincts/FramPrecincts.shp", as.sf = TRUE)

```

*data/gis/framingham_basemap.Rda* - A leaflet HTML widget of Framingham districts and precincts that I created from Framingham precinct shapefile.

### R files

*R/config.R* -- Setup needed to run these scripts, including installing packages not on your system. **Run config.R before trying to run any other R scripts in this project.**

### For analysis

*R/get_turnouts.R* -- get a tidy data frame of all available election turnout data by precinct, stored in an R object called `all_turnout_data`.



## Info on reproducibility

These are the scripts I used to turn raw data into analysis-friendly data.

*R/election_general_2017_framingham.R* -- R file to convert November 2017 official results spreadsheet to an analysis-friendly format.

*R/election_preliminary_2017_framingham.R* -- R file to convert September 2017 official results spreadsheet to an analysis-friendly format.

*R/election_charter_2017.R* -- R file to convert April 2017 city charter results to analysis-friendly format.

*R/election_helpers.R* -- file with some useful functions for working with Framingham election data.




